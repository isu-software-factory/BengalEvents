
<h1>Team <%=@team.name %></h1>
<h2>Team Members</h2>
<table>
  <thead>
  <tr>
    <th>Member</th>
    <th>Position</th>
    <%if policy(@team).change? %>
      <th>Drop Member</th>
    <%end %>
  </tr>
  </thead>
  <tbody>
  <%@team.students.each do |m| %>
    <tr>
      <td><%=m.name %></td>
      <%if m == @team.get_lead %>
        <td>Team Lead</td>
      <%else %>
        <td>Member</td>
      <%end %>
      <%if policy(@team).change? %>
        <%if m == @team.get_lead %>
          <td>Can't Drop Team Lead</td>
        <%else %>
          <td><%=button_to "Drop",  method: :post, controller: "groupings", action: :drop, part_id: m.id, id: @team.id%></td>
        <%end %>
      <%end %>
    </tr>
  <% end %>
  </tbody>
</table>

<div>
  <h2>Registration Details</h2>
  <table>
    <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Location</th>
      <th>Start Time</th>
      <th>End Time</th>
      <%if policy(@team).change? %>
        <th>Modify</th>
      <%end %>
    </tr>
    </thead>
    <tbody>
      <% @team.participant.event_details.each do |s| %>
        <tr>
          <td><%=Event.find(s.event_id).name %></td>
          <td><%=Event.find(s.event_id).description %></td>
          <td><%=Event.find(s.event_id).location.name %></td>
          <td><%=s.start_time %></td>
          <td><%=s.end_time %></td>
          <%if policy(@team).change? %>
            <td>
              <%=button_to "Drop Event", controller: "registrations", action: :drop, part_id: @team.participant.id, id: s.id %>
            </td>
          <%end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<%if policy(@team).change? %>
  <div>
    <%=link_to "Invite Members", controller: "teams", action: "invite", id: @team.id %>
  </div>
  <%if @team.students.count > 1 %>
    <div>
      <%=link_to("Register for events as a team", controller: "registrations", action: "index", part_id: @team.participant.id)%>
    </div>
  <%else %>
    <p>You have to have at least two members to register for an event as a team.</p>
  <%end %>
<%end %>

